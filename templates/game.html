{% extends 'base.html' %}
{% block content %}
{% raw %}
<div id="app">
  <board :data="wordBoardData" :size="boardSize"></board>
  <br></br>
</div>
{% endraw %}
{% endblock %}
{% block scripts %}
{% raw %}
<script type="text/x-template" id="board-template">
  <table class="primary">
    <thead>
      <tr>
        <th>Player</th>
        <th>Role</th>
        <th v-if="teamColor==='RED'" style="background-color: #ff4136">
          Player
        </th>
        <th v-if="teamColor==='RED'" style="background-color: #ff4136">
          Role
        </th>
    </thead>
    <tbody>
      <tr v-for="player in players">
        <td>
          <img class="avatar" :src="avatarUri + player.avatar + '.png'">
          </img>
        </td>
        <td>
          <select style="width: 200px" :disabled="player.id !== socket.id">
            <option v-if="player.id === socket.id">Select your role</option>
            <option v-if="player.id !== socket.id">Selecting a role</option>
            <option>Spymaster</option>
            <option>Operative</option>
          </select>
        </td>
      </tr>
    </tbody>
  </table>
</script>
{% endraw %}
<script>
  Vue.component('board', {
    template: '#board-template',
    props: {
      data: Array,
      size: Number,
    },
    computed: {
      boardData: function () {
        var data = this.data;
        var size = this.size;
        var rowSize = Math.sqrt(size);
        var boardData = [];
        while (data.length) boardData.push(data.splice(0, rowSize));
        return boardData;
      }
    }
  });

  var words = {{ game_bundle.deck }};

  var wordBoardData = words.map(function(word) {
    return {
      word: word
    };
  });


  var boardSize = {{ game_bundle.deck }}.length;
  var startingColor = {{ game_bundle.current_turn }};

  var App = new Vue({
    el: '#app',
    data: {
      boardSize: boardSize,
      wordBoardData: wordBoardData,
    }
  });
</script>
{% endblock %}
